//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../pdfreporter-core/src/org/oss/pdfreporter/engine/component/ComponentsEnvironment.java
//

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "java/util/Collection.h"
#include "java/util/HashMap.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "org/oss/pdfreporter/engine/DefaultJasperReportsContext.h"
#include "org/oss/pdfreporter/engine/JRRuntimeException.h"
#include "org/oss/pdfreporter/engine/JasperReportsContext.h"
#include "org/oss/pdfreporter/engine/component/ComponentKey.h"
#include "org/oss/pdfreporter/engine/component/ComponentsBundle.h"
#include "org/oss/pdfreporter/engine/component/ComponentsEnvironment.h"
#include "org/oss/pdfreporter/engine/component/ComponentsXmlParser.h"
#include "org/oss/pdfreporter/engine/component/IComponentManager.h"
#include "org/oss/pdfreporter/extensions/ExtensionsEnvironment.h"
#include "org/oss/pdfreporter/uses/org/apache/commons/collections/ReferenceMap.h"

@interface OrgOssPdfreporterEngineComponentComponentsEnvironment () {
 @public
  OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap *cache_;
  id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext_;
}

- (instancetype)initWithOrgOssPdfreporterEngineJasperReportsContext:(id<OrgOssPdfreporterEngineJasperReportsContext>)jasperReportsContext;

+ (OrgOssPdfreporterEngineComponentComponentsEnvironment *)getDefaultInstance;

@end

J2OBJC_FIELD_SETTER(OrgOssPdfreporterEngineComponentComponentsEnvironment, cache_, OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap *)
J2OBJC_FIELD_SETTER(OrgOssPdfreporterEngineComponentComponentsEnvironment, jasperReportsContext_, id<OrgOssPdfreporterEngineJasperReportsContext>)

__attribute__((unused)) static void OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(OrgOssPdfreporterEngineComponentComponentsEnvironment *self, id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext);

__attribute__((unused)) static OrgOssPdfreporterEngineComponentComponentsEnvironment *new_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgOssPdfreporterEngineComponentComponentsEnvironment *create_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext);

__attribute__((unused)) static OrgOssPdfreporterEngineComponentComponentsEnvironment *OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance();

@implementation OrgOssPdfreporterEngineComponentComponentsEnvironment

- (instancetype)initWithOrgOssPdfreporterEngineJasperReportsContext:(id<OrgOssPdfreporterEngineJasperReportsContext>)jasperReportsContext {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(self, jasperReportsContext);
  return self;
}

+ (OrgOssPdfreporterEngineComponentComponentsEnvironment *)getDefaultInstance {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance();
}

+ (OrgOssPdfreporterEngineComponentComponentsEnvironment *)getInstanceWithOrgOssPdfreporterEngineJasperReportsContext:(id<OrgOssPdfreporterEngineJasperReportsContext>)jasperReportsContext {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getInstanceWithOrgOssPdfreporterEngineJasperReportsContext_(jasperReportsContext);
}

- (id<JavaUtilCollection>)getBundles {
  id<JavaUtilMap> components = [self getCachedBundles];
  return [((id<JavaUtilMap>) nil_chk(components)) values];
}

- (id<JavaUtilMap>)getCachedBundles {
  id cacheKey = OrgOssPdfreporterExtensionsExtensionsEnvironment_getExtensionsCacheKey();
  @synchronized(cache_) {
    id<JavaUtilMap> components = (id<JavaUtilMap>) cast_check([((OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap *) nil_chk(cache_)) getWithId:cacheKey], JavaUtilMap_class_());
    if (components == nil) {
      components = [self findBundles];
      (void) [cache_ putWithId:cacheKey withId:components];
    }
    return components;
  }
}

- (id<JavaUtilMap>)findBundles {
  id<JavaUtilMap> components = new_JavaUtilHashMap_init();
  id<JavaUtilList> bundles = [((id<OrgOssPdfreporterEngineJasperReportsContext>) nil_chk(jasperReportsContext_)) getExtensionsWithIOSClass:OrgOssPdfreporterEngineComponentComponentsBundle_class_()];
  for (id<JavaUtilIterator> it = [((id<JavaUtilList>) nil_chk(bundles)) iterator]; [((id<JavaUtilIterator>) nil_chk(it)) hasNext]; ) {
    id<OrgOssPdfreporterEngineComponentComponentsBundle> bundle = [it next];
    NSString *namespace_ = [((id<OrgOssPdfreporterEngineComponentComponentsXmlParser>) nil_chk([((id<OrgOssPdfreporterEngineComponentComponentsBundle>) nil_chk(bundle)) getXmlParser])) getNamespace];
    if ([components containsKeyWithId:namespace_]) {
    }
    else {
      (void) [components putWithId:namespace_ withId:bundle];
    }
  }
  return components;
}

- (id<OrgOssPdfreporterEngineComponentComponentsBundle>)getBundleWithNSString:(NSString *)namespace_ {
  id<JavaUtilMap> components = [self getCachedBundles];
  id<OrgOssPdfreporterEngineComponentComponentsBundle> componentsBundle = [((id<JavaUtilMap>) nil_chk(components)) getWithId:namespace_];
  if (componentsBundle == nil) {
    @throw new_OrgOssPdfreporterEngineJRRuntimeException_initWithNSString_(JreStrcat("$$", @"No components bundle registered for namespace ", namespace_));
  }
  return componentsBundle;
}

- (id<OrgOssPdfreporterEngineComponentIComponentManager>)getManagerWithOrgOssPdfreporterEngineComponentComponentKey:(OrgOssPdfreporterEngineComponentComponentKey *)componentKey {
  NSString *namespace_ = [((OrgOssPdfreporterEngineComponentComponentKey *) nil_chk(componentKey)) getNamespace];
  id<OrgOssPdfreporterEngineComponentComponentsBundle> componentsBundle = [self getBundleWithNSString:namespace_];
  NSString *name = [componentKey getName];
  return [((id<OrgOssPdfreporterEngineComponentComponentsBundle>) nil_chk(componentsBundle)) getComponentManagerWithNSString:name];
}

+ (id<JavaUtilCollection>)getComponentBundles {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentBundles();
}

+ (id<JavaUtilMap>)getCachedComponentBundles {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getCachedComponentBundles();
}

+ (id<JavaUtilMap>)findComponentBundles {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_findComponentBundles();
}

+ (id<OrgOssPdfreporterEngineComponentComponentsBundle>)getComponentsBundleWithNSString:(NSString *)namespace_ {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentsBundleWithNSString_(namespace_);
}

+ (id<OrgOssPdfreporterEngineComponentIComponentManager>)getComponentManagerWithOrgOssPdfreporterEngineComponentComponentKey:(OrgOssPdfreporterEngineComponentComponentKey *)componentKey {
  return OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentManagerWithOrgOssPdfreporterEngineComponentComponentKey_(componentKey);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgOssPdfreporterEngineJasperReportsContext:", "ComponentsEnvironment", NULL, 0x2, NULL, NULL },
    { "getDefaultInstance", NULL, "Lorg.oss.pdfreporter.engine.component.ComponentsEnvironment;", 0xa, NULL, NULL },
    { "getInstanceWithOrgOssPdfreporterEngineJasperReportsContext:", "getInstance", "Lorg.oss.pdfreporter.engine.component.ComponentsEnvironment;", 0x9, NULL, NULL },
    { "getBundles", NULL, "Ljava.util.Collection;", 0x1, NULL, "()Ljava/util/Collection<Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "getCachedBundles", NULL, "Ljava.util.Map;", 0x4, NULL, "()Ljava/util/Map<Ljava/lang/String;Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "findBundles", NULL, "Ljava.util.Map;", 0x4, NULL, "()Ljava/util/Map<Ljava/lang/String;Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "getBundleWithNSString:", "getBundle", "Lorg.oss.pdfreporter.engine.component.ComponentsBundle;", 0x1, NULL, NULL },
    { "getManagerWithOrgOssPdfreporterEngineComponentComponentKey:", "getManager", "Lorg.oss.pdfreporter.engine.component.IComponentManager;", 0x1, NULL, NULL },
    { "getComponentBundles", NULL, "Ljava.util.Collection;", 0x9, NULL, "()Ljava/util/Collection<Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "getCachedComponentBundles", NULL, "Ljava.util.Map;", 0xc, NULL, "()Ljava/util/Map<Ljava/lang/String;Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "findComponentBundles", NULL, "Ljava.util.Map;", 0xc, NULL, "()Ljava/util/Map<Ljava/lang/String;Lorg/oss/pdfreporter/engine/component/ComponentsBundle;>;" },
    { "getComponentsBundleWithNSString:", "getComponentsBundle", "Lorg.oss.pdfreporter.engine.component.ComponentsBundle;", 0x9, NULL, NULL },
    { "getComponentManagerWithOrgOssPdfreporterEngineComponentComponentKey:", "getComponentManager", "Lorg.oss.pdfreporter.engine.component.IComponentManager;", 0x9, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "cache_", NULL, 0x12, "Lorg.oss.pdfreporter.uses.org.apache.commons.collections.ReferenceMap;", NULL, NULL, .constantValue.asLong = 0 },
    { "jasperReportsContext_", NULL, 0x2, "Lorg.oss.pdfreporter.engine.JasperReportsContext;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgOssPdfreporterEngineComponentComponentsEnvironment = { 2, "ComponentsEnvironment", "org.oss.pdfreporter.engine.component", NULL, 0x11, 13, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgOssPdfreporterEngineComponentComponentsEnvironment;
}

@end

void OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(OrgOssPdfreporterEngineComponentComponentsEnvironment *self, id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext) {
  NSObject_init(self);
  self->cache_ = new_OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap_initWithInt_withInt_(OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap_WEAK, OrgOssPdfreporterUsesOrgApacheCommonsCollectionsReferenceMap_HARD);
  self->jasperReportsContext_ = jasperReportsContext;
}

OrgOssPdfreporterEngineComponentComponentsEnvironment *new_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext) {
  J2OBJC_NEW_IMPL(OrgOssPdfreporterEngineComponentComponentsEnvironment, initWithOrgOssPdfreporterEngineJasperReportsContext_, jasperReportsContext)
}

OrgOssPdfreporterEngineComponentComponentsEnvironment *create_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext) {
  J2OBJC_CREATE_IMPL(OrgOssPdfreporterEngineComponentComponentsEnvironment, initWithOrgOssPdfreporterEngineJasperReportsContext_, jasperReportsContext)
}

OrgOssPdfreporterEngineComponentComponentsEnvironment *OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance() {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return new_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(OrgOssPdfreporterEngineDefaultJasperReportsContext_getInstance());
}

OrgOssPdfreporterEngineComponentComponentsEnvironment *OrgOssPdfreporterEngineComponentComponentsEnvironment_getInstanceWithOrgOssPdfreporterEngineJasperReportsContext_(id<OrgOssPdfreporterEngineJasperReportsContext> jasperReportsContext) {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return new_OrgOssPdfreporterEngineComponentComponentsEnvironment_initWithOrgOssPdfreporterEngineJasperReportsContext_(jasperReportsContext);
}

id<JavaUtilCollection> OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentBundles() {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return [((OrgOssPdfreporterEngineComponentComponentsEnvironment *) nil_chk(OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance())) getBundles];
}

id<JavaUtilMap> OrgOssPdfreporterEngineComponentComponentsEnvironment_getCachedComponentBundles() {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return [((OrgOssPdfreporterEngineComponentComponentsEnvironment *) nil_chk(OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance())) getCachedBundles];
}

id<JavaUtilMap> OrgOssPdfreporterEngineComponentComponentsEnvironment_findComponentBundles() {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return [((OrgOssPdfreporterEngineComponentComponentsEnvironment *) nil_chk(OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance())) findBundles];
}

id<OrgOssPdfreporterEngineComponentComponentsBundle> OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentsBundleWithNSString_(NSString *namespace_) {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return [((OrgOssPdfreporterEngineComponentComponentsEnvironment *) nil_chk(OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance())) getBundleWithNSString:namespace_];
}

id<OrgOssPdfreporterEngineComponentIComponentManager> OrgOssPdfreporterEngineComponentComponentsEnvironment_getComponentManagerWithOrgOssPdfreporterEngineComponentComponentKey_(OrgOssPdfreporterEngineComponentComponentKey *componentKey) {
  OrgOssPdfreporterEngineComponentComponentsEnvironment_initialize();
  return [((OrgOssPdfreporterEngineComponentComponentsEnvironment *) nil_chk(OrgOssPdfreporterEngineComponentComponentsEnvironment_getDefaultInstance())) getManagerWithOrgOssPdfreporterEngineComponentComponentKey:componentKey];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgOssPdfreporterEngineComponentComponentsEnvironment)
