//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../pdfreporter-core/src/org/oss/pdfreporter/compilers/javascript/marshaller/ClassCompiler.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Integer.h"
#include "java/util/HashMap.h"
#include "java/util/Map.h"
#include "java/util/logging/Level.h"
#include "java/util/logging/Logger.h"
#include "org/oss/pdfreporter/compilers/javascript/factory/ICompilerEnvirons.h"
#include "org/oss/pdfreporter/compilers/javascript/interpreter/factory/IJavaScriptInterpreterFactory.h"
#include "org/oss/pdfreporter/compilers/javascript/interpreter/factory/IScriptEngine.h"
#include "org/oss/pdfreporter/compilers/javascript/marshaller/ClassCompiler.h"
#include "org/oss/pdfreporter/compilers/javascript/marshaller/PrototypeToFunctionConverter.h"
#include "org/oss/pdfreporter/registry/ApiRegistry.h"

@interface OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler () {
 @public
  jint instance_;
  id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons> environemnt_;
  id<JavaUtilMap> scriptEngineCache_;
}

- (id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine>)resolveEngineWithNSString:(NSString *)source
                                                                                        withNSString:(NSString *)mainClassName;

- (id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine>)createEngineWithNSString:(NSString *)mainClassName
                                                                                       withNSString:(NSString *)functionPrototype;

@end

J2OBJC_FIELD_SETTER(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, environemnt_, id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons>)
J2OBJC_FIELD_SETTER(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, scriptEngineCache_, id<JavaUtilMap>)

inline JavaUtilLoggingLogger *OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_get_logger();
static JavaUtilLoggingLogger *OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, logger, JavaUtilLoggingLogger *)

inline jint OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_get_COUNT();
inline jint OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_set_COUNT(jint value);
inline jint *OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_getRef_COUNT();
static jint OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_COUNT = 0;
J2OBJC_STATIC_FIELD_PRIMITIVE(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, COUNT, jint)

__attribute__((unused)) static id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine> OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_resolveEngineWithNSString_withNSString_(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *self, NSString *source, NSString *mainClassName);

__attribute__((unused)) static id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine> OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_createEngineWithNSString_withNSString_(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *self, NSString *mainClassName, NSString *functionPrototype);

J2OBJC_INITIALIZED_DEFN(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler)

@implementation OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler

- (instancetype)initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons:(id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons>)environemnt {
  OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_(self, environemnt);
  return self;
}

- (IOSObjectArray *)compileToClassFilesWithNSString:(NSString *)source
                                       withNSString:(NSString *)sourceLocation
                                            withInt:(jint)lineno
                                       withNSString:(NSString *)mainClassName {
  [((JavaUtilLoggingLogger *) nil_chk(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger)) finestWithNSString:NSString_formatWithNSString_withNSObjectArray_(@"compile: %s at %s for env: %s, engineCacheSize: %s\n%s", [IOSObjectArray newArrayWithObjects:(id[]){ mainClassName, sourceLocation, environemnt_, JavaLangInteger_valueOfWithInt_([((id<JavaUtilMap>) nil_chk(scriptEngineCache_)) size]), source } count:5 type:NSObject_class_()])];
  (void) OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_resolveEngineWithNSString_withNSString_(self, source, mainClassName);
  return [IOSObjectArray newArrayWithObjects:(id[]){ mainClassName, [((NSString *) nil_chk(mainClassName)) getBytes] } count:2 type:NSObject_class_()];
}

- (jboolean)hasEngineForClassNameWithNSString:(NSString *)name {
  return [((id<JavaUtilMap>) nil_chk(scriptEngineCache_)) containsKeyWithId:name];
}

- (id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine>)getEngineByClassNameWithNSString:(NSString *)name {
  return [((id<JavaUtilMap>) nil_chk(scriptEngineCache_)) getWithId:name];
}

- (id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine>)resolveEngineWithNSString:(NSString *)source
                                                                                        withNSString:(NSString *)mainClassName {
  return OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_resolveEngineWithNSString_withNSString_(self, source, mainClassName);
}

- (id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine>)createEngineWithNSString:(NSString *)mainClassName
                                                                                       withNSString:(NSString *)functionPrototype {
  return OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_createEngineWithNSString_withNSString_(self, mainClassName, functionPrototype);
}

- (NSString *)description {
  return JreStrcat("$IC", @"ClassCompiler [instance=", instance_, ']');
}

+ (void)initialize {
  if (self == [OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler class]) {
    OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger = JavaUtilLoggingLogger_getLoggerWithNSString_([OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_class_() getName]);
    J2OBJC_SET_INITIALIZED(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons:", "ClassCompiler", NULL, 0x0, NULL, NULL },
    { "compileToClassFilesWithNSString:withNSString:withInt:withNSString:", "compileToClassFiles", "[Ljava.lang.Object;", 0x1, NULL, NULL },
    { "hasEngineForClassNameWithNSString:", "hasEngineForClassName", "Z", 0x0, NULL, NULL },
    { "getEngineByClassNameWithNSString:", "getEngineByClassName", "Lorg.oss.pdfreporter.compilers.javascript.interpreter.factory.IScriptEngine;", 0x0, NULL, NULL },
    { "resolveEngineWithNSString:withNSString:", "resolveEngine", "Lorg.oss.pdfreporter.compilers.javascript.interpreter.factory.IScriptEngine;", 0x2, NULL, NULL },
    { "createEngineWithNSString:withNSString:", "createEngine", "Lorg.oss.pdfreporter.compilers.javascript.interpreter.factory.IScriptEngine;", 0x2, NULL, NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "logger", "logger", 0x1a, "Ljava.util.logging.Logger;", &OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger, NULL, .constantValue.asLong = 0 },
    { "COUNT", "COUNT", 0xa, "I", &OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_COUNT, NULL, .constantValue.asLong = 0 },
    { "instance_", NULL, 0x12, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "environemnt_", NULL, 0x12, "Lorg.oss.pdfreporter.compilers.javascript.factory.ICompilerEnvirons;", NULL, NULL, .constantValue.asLong = 0 },
    { "scriptEngineCache_", NULL, 0x12, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Lorg/oss/pdfreporter/compilers/javascript/interpreter/factory/IScriptEngine;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler = { 2, "ClassCompiler", "org.oss.pdfreporter.compilers.javascript.marshaller", NULL, 0x1, 7, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler;
}

@end

void OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *self, id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons> environemnt) {
  NSObject_init(self);
  self->instance_ = OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_COUNT++;
  self->environemnt_ = environemnt;
  self->scriptEngineCache_ = new_JavaUtilHashMap_init();
}

OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *new_OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_(id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons> environemnt) {
  J2OBJC_NEW_IMPL(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_, environemnt)
}

OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *create_OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_(id<OrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons> environemnt) {
  J2OBJC_CREATE_IMPL(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler, initWithOrgOssPdfreporterCompilersJavascriptFactoryICompilerEnvirons_, environemnt)
}

id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine> OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_resolveEngineWithNSString_withNSString_(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *self, NSString *source, NSString *mainClassName) {
  if (![((id<JavaUtilMap>) nil_chk(self->scriptEngineCache_)) containsKeyWithId:mainClassName]) {
    id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine> engine = OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_createEngineWithNSString_withNSString_(self, mainClassName, source);
    (void) [self->scriptEngineCache_ putWithId:mainClassName withId:engine];
  }
  return [self->scriptEngineCache_ getWithId:mainClassName];
}

id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIScriptEngine> OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_createEngineWithNSString_withNSString_(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler *self, NSString *mainClassName, NSString *functionPrototype) {
  [((JavaUtilLoggingLogger *) nil_chk(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger)) finerWithNSString:NSString_formatWithNSString_withNSObjectArray_(@"create script engine: '%s', function: %s, code:\n%s", [IOSObjectArray newArrayWithObjects:(id[]){ mainClassName, OrgOssPdfreporterCompilersJavascriptMarshallerPrototypeToFunctionConverter_FUNCTION_NAME, functionPrototype } count:3 type:NSObject_class_()])];
  OrgOssPdfreporterCompilersJavascriptMarshallerPrototypeToFunctionConverter *converter = new_OrgOssPdfreporterCompilersJavascriptMarshallerPrototypeToFunctionConverter_initWithNSString_(functionPrototype);
  NSString *javascriptFunction = [converter toJavaScriptFunction];
  if ([OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger isLoggableWithJavaUtilLoggingLevel:JreLoadStatic(JavaUtilLoggingLevel, FINEST)]) {
    [OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler_logger finestWithNSString:NSString_formatWithNSString_withNSObjectArray_(@"converted script: '%s':\n%s", [IOSObjectArray newArrayWithObjects:(id[]){ mainClassName, javascriptFunction } count:2 type:NSObject_class_()])];
  }
  return [((id<OrgOssPdfreporterCompilersJavascriptInterpreterFactoryIJavaScriptInterpreterFactory>) nil_chk(OrgOssPdfreporterRegistryApiRegistry_getJavaScriptInterpreterFactory())) createFunctionEngineWithNSString:mainClassName withNSString:javascriptFunction withNSString:OrgOssPdfreporterCompilersJavascriptMarshallerPrototypeToFunctionConverter_FUNCTION_NAME];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgOssPdfreporterCompilersJavascriptMarshallerClassCompiler)
